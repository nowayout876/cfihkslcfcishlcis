<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Palestine Profile Maker - FalasTech</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
    }
  </script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    canvas {
      cursor: move;
      transition: opacity 0.3s ease-in-out;
    }
    dialog::backdrop {
      background: rgba(0, 0, 0, 0.5);
    }
    .icon-transition {
      transition: transform 0.3s ease, opacity 0.3s ease;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-100 min-h-screen font-sans">
  <div class="max-w-xl mx-auto p-4">
    <div class="flex justify-end mb-4">
      <button onclick="toggleDarkMode()" class="text-sm px-3 py-1 rounded bg-gray-200 dark:bg-gray-700 dark:text-white flex items-center gap-2">
        <i id="themeIcon" data-lucide="sun" class="w-5 h-5 icon-transition"></i>
      </button>
    </div><div id="browserWarning" class="hidden bg-red-100 text-red-700 p-2 mb-4 rounded font-medium text-sm text-center dark:bg-red-800 dark:text-white">Unsupported Browser Detected. Please open this page in your default browser for best experience.</div>

<h1 class="text-3xl font-extrabold mb-2 text-center">Raise Your Voice <span class="text-gray-400 text-xl">ðŸ‡µðŸ‡¸</span></h1>
<p class="mb-4 text-center text-gray-600 dark:text-gray-300">Letâ€™s stand as one by reflecting the cause in our profile pictures. âœŠ</p>
<div class="flex justify-center mb-4">
  <canvas id="canvas" width="300" height="300" class="rounded-full border-4 border-gray-300 dark:border-gray-600 shadow-md"></canvas>
</div>

<div class="mb-6 text-center">
  <label for="frameSelect" class="block mb-1 font-medium">Choose a Frame:</label>
  <select id="frameSelect" class="w-full px-4 py-2 rounded bg-white dark:bg-gray-800 border dark:border-gray-600">
    <option value="default">Default</option>
    <option value="flag">With Country Flag</option>
    <option value="freepalestine">#FreePalestine Overlay</option>
  </select>
</div>

<div id="countryFlagSelectWrapper" class="mb-6 text-center hidden">
  <label for="countryFlagSelect" class="block mb-1 font-medium">Select Country Flag:</label>
  <select id="countryFlagSelect" class="w-full px-4 py-2 rounded bg-white dark:bg-gray-800 border dark:border-gray-600">
    <option value="us">ðŸ‡ºðŸ‡¸ United States</option>
    <option value="uk">ðŸ‡¬ðŸ‡§ United Kingdom</option>
    <option value="sa">ðŸ‡¸ðŸ‡¦ Saudi Arabia</option>
    <option value="eg">ðŸ‡ªðŸ‡¬ Egypt</option>
    <option value="fr">ðŸ‡«ðŸ‡· France</option>
    <option value="de">ðŸ‡©ðŸ‡ª Germany</option>
    <!-- Add more flags as needed -->
  </select>
</div>

<div id="inputSection">
  <div class="flex justify-center mb-6">
    <label for="upload" class="flex items-center gap-2 px-4 py-2 rounded-full bg-blue-600 text-white cursor-pointer hover:bg-blue-700">
      <i data-lucide="image" class="w-5 h-5"></i> Upload Image
    </label>
    <input type="file" id="upload" accept="image/*" class="hidden" />
  </div>

  <div class="flex flex-col items-center gap-3 mb-6">
    <button onclick="fetchAvatar('x')" class="px-4 py-2 rounded bg-black text-white hover:bg-gray-800 w-full text-center">
     Use <img src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/x.svg" alt="X" class="inline-block h-5 w-5 mx-1 align-middle filter invert"> Profile Pic
    </button>

    <button onclick="fetchAvatar('github')" class="px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-700 w-full text-center">
     Use <img src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/github.svg" alt="GitHub" class="inline-block h-5 w-5 mx-1 align-middle filter invert"> Profile Pic
    </button>

    <button onclick="fetchAvatar('gitlab')" class="px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700 w-full text-center">
     Use <img src="https://cdn.jsdelivr.net/npm/simple-icons@v9/icons/gitlab.svg" alt="GitLab" class="inline-block h-5 w-5 mx-1 align-middle filter invert"> Profile Pic
    </button>
  </div>
</div>

<div id="finalButtons" class="space-y-2 hidden">
  <button onclick="downloadImage()" class="w-full px-5 py-2 rounded-full bg-green-600 text-white hover:bg-green-700 shadow">Download Image</button>
  <button onclick="backToEdit()" class="w-full px-5 py-2 rounded-full bg-gray-500 text-white hover:bg-gray-600 shadow">Back to Edit</button>
  <button onclick="startOver()" class="w-full px-5 py-2 rounded-full bg-red-500 text-white hover:bg-red-600 shadow">Start Over</button>
</div>

<p class="text-xs mt-4 text-gray-400 dark:text-gray-500 text-center">Note: This tool works entirely in your browser. We donâ€™t store or share your data.</p>

  </div>  <script>
    const countryFlagSelectWrapper = document.getElementById('countryFlagSelectWrapper');
    const countryFlagSelect = document.getElementById('countryFlagSelect');
    const frames = {
      default: "bg.webp",
      flag: "bg.webp", // base frame reused
      freepalestine: "frame_freepalestine.webp",
    };

    document.getElementById("frameSelect").addEventListener("change", (e) => {
      const val = e.target.value;
      currentFrameKey = val;
      if (val === "flag") {
        countryFlagSelectWrapper.classList.remove("hidden");
      } else {
        countryFlagSelectWrapper.classList.add("hidden");
      }
      drawMainCanvas();
    });

    countryFlagSelect.addEventListener("change", () => drawMainCanvas());

    function drawCanvas(context, image) {
      context.clearRect(0, 0, 300, 300);
      const base = new Image();
      base.src = frames[currentFrameKey];
      base.onload = () => {
        context.drawImage(base, 0, 0, 300, 300);
        if (image && image.complete && image.naturalWidth !== 0) {
          context.save();
          context.beginPath();
          context.arc(150, 150, 130, 0, Math.PI * 2);
          context.closePath();
          context.clip();
          context.translate(150, 150);
          context.rotate(rotation);
          const size = 300 * scale;
          context.drawImage(image, -size / 2 + (imgX - 150), -size / 2 + (imgY - 150), size, size);
          context.restore();
        }

        if (currentFrameKey === "flag") {
          const selectedFlag = countryFlagSelect.value;
          const flagImg = new Image();
          flagImg.src = `flags/${selectedFlag}.webp`;
          flagImg.onload = () => {
            context.drawImage(flagImg, 0, 240, 300, 60); // bottom overlay
          };
        }
      };
    }
  </script></body>
</html>
